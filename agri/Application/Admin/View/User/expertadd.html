<extend name="Public/base" />

<block name="body">
<div class="main-title">
	<h2>{$info['id']?'编辑':'新增'}专家</h2>
</div>

<form action="{:U()}" method="post" class="form-horizontal">
	<input type="hidden" name="id" value="{$info.id}" /> 
	<input type="hidden" name="uid" value="{$info.uid}" /> 
	<input type="hidden" name="role" value="{$info.role}" />
	<input type="hidden" name="pcode" value="{$info.pcode}" />
	<input type="hidden" name="login" value="{$info.login}" />
	<input type="hidden" name="reg_time" value="{$info.reg_time}" />
	<input type="hidden" name="status"  />
	<input type="hidden" name="last_login_time" value="{$info.last_login_time}" />
	<input type="hidden" name="status" value="{$info.status}" />
	<div style="width: 200px; height: 250px; position: absolute; left: 1100px; border: 1px solid #333;">
		<div class="controls">
			<input type="file" id="upload_picture_photo">
			<input type="hidden" name="photo" id="cover_id_photo" value="{$info.photo}" />
			<div class="upload-img-box">
				<notempty name="info['photo']">
					<div class="upload-pre-item"><img style="max-height: 200px;max-width: 200px;" src="{$info['photo']}"/></div>
				</notempty>
			</div>
		</div>
	</div>
	<div class="layui-form-item">
		<div class="layui-inline">
			<label class="layui-form-label" style="width: 215px;">用户名（英文加数字6-10位）</label>
			<div class="layui-input-inline">
				<input type="text" class="layui-input" name="username"
					onkeyup="value=value.replace(/[^\w\.\/]/ig,'')" maxlength="10"
					value="{$info.username}">
			</div>
		</div>
		<div class="layui-inline">
			<label class="layui-form-label" style="width: 135px;">昵称（显示）</label>
			<div class="layui-input-inline">
				<input type="text" class="layui-input" name="nickname"
					maxlength="32" value="{$info.nickname}">
			</div>
		</div>
	</div>
	<div class="layui-form-item">
		<div class="layui-inline">
			<label class="layui-form-label" style="width: 215px;">密码（用户密码长度在6-10位）</label>
			<div class="layui-input-inline">
				<input type="password" class="layui-input" name="password"
					onkeyup="value=value.replace(/[^\w\.\/]/ig,'')" maxlength="10"
					value="{$info.password}">
			</div>
		</div>
		<div class="layui-inline">
			<label class="layui-form-label" style="width: 135px;">确认密码</label>
			<div class="layui-input-inline">
				<input type="password" class="layui-input" name="repassword"
					onkeyup="value=value.replace(/[^\w\.\/]/ig,'')" maxlength="10"
					value="{$info.password}">
			</div>
		</div>
	</div>
	<div class="layui-form-item">
		<div class="layui-inline">
			<label class="layui-form-label" style="width: 215px;">姓名（5个字内）</label>
			<div class="layui-input-inline">
				<input type="text" class="layui-input" name="name" maxlength="5"
					value="{$info.name}">
			</div>
		</div>
		<div class="layui-inline">
			<label class="layui-form-label" style="width: 135px;">性别</label>
			<div class="layui-input-inline"
				style="margin-top: 10px; width: 122px;">
				<div class="layui-input-inline" style="width: 50px;">
					<input type="radio"  name="gender" value="1">男
				</div>
				<div class="layui-input-inline" style="width: 50px;">
					<input type="radio"  name="gender" value="0">女
				</div>
			</div>
		</div>
	</div>
	<div class="layui-form-item">
		<div class="layui-inline">
			<label class="layui-form-label" style="width: 215px;">手机号</label>
			<div class="layui-input-inline">
				<input type="text" class="layui-input" name="mobile"
					onkeyup="value=value.replace(/[^\d]/g,'')" maxlength="11" value="{$info.mobile}">
			</div>
		</div>
		<div class="layui-inline">
			<label class="layui-form-label" style="width: 135px;">电话</label>
			<div class="layui-input-inline">
				<input type="text" class="layui-input" name="telephone" value="{$info.telephone}">
			</div>
		</div>
	</div>
	<div class="layui-form-item">
		<div class="layui-inline">
			<label class="layui-form-label" style="width: 215px;">等级</label>
			<div class="layui-input-inline">
				<input type="text" class="layui-input" name="mlevel" value="{$info.mlevel}"
					onkeyup="value=value.replace(/[^\d]/g,'')" maxlength="11">
			</div>
		</div>
		<div class="layui-inline">
			<label class="layui-form-label" style="width: 135px;">专业</label>
			<div class="layui-input-inline">
				<input type="text" class="layui-input" name="specialty"
					maxlength="10" value="{$info.specialty}">
			</div>
		</div>
	</div>
	<div class="layui-form-item">
		<div class="layui-inline">
			<label class="layui-form-label" style="width: 215px;">擅长领域</label>
			<div class="layui-input-inline">
				<select name="areas" class="layui-input">
					<option value="0">全部</option>
					<volist name="group" id="vo">
						<option value="{$vo.id}">{$vo.title}</option>
					</volist>
				</select>
			</div>
		</div>
		<div class="layui-inline">
			<label class="layui-form-label" style="width: 135px;">积分</label>
			<div class="layui-input-inline">
				<input type="text" class="layui-input" name="score" value="{$info.score}"
					onkeyup="value=value.replace(/[^\d]/g,'')" maxlength="11">
			</div>
		</div>
	</div>
	<div class="layui-form-item">
		<div class="layui-inline">
			<label class="layui-form-label" style="width: 215px;">职称</label>
			<div class="layui-input-inline">
				<select name="education" class="layui-input">
					<option value="大专">大专</option>
					<option value="本科">本科</option>
					<option value="研究生">研究生</option>
				</select>
			</div>
		</div>

		<div class="layui-inline">
			<label class="layui-form-label" style="width: 135px;">地区(支持两级：市-区/省-市)</label>
			<div class="layui-input-inline" style="width:auto;">
				<!--<input type="text" class="layui-input" name="region" maxlength="25"
					value="{$info.region}">-->
				<select style="display:inline-block;margin-top:15px;" name="region_p" id="region_p"></select>
                <select style="display:inline-block;" name="region_c" id="region_c"></select>
                <select style="display:inline-block;" name="region_a" id="region_a"></select>
			</div>
		</div>
	</div>
	<div class="layui-form-item">
		<div class="layui-inline">
			<label class="layui-form-label" style="width: 215px;">推荐码(系统自动生成)</label>
			<div class="layui-input-inline">
				<input type="text" class="layui-input" name="code"
					maxlength="25" value="{$info.code}"disabled="disabled"/>
			</div>
		</div>
	</div>
	<div class="layui-form-item">
		<label class="layui-form-label" style="width: 135px;">简历</label>
	</div>

	<label class="textarea"> <textarea name="content">{$info.content}</textarea>
		{:hook('adminArticleEdit', array('name'=>'content','value'=>$info.content))}
	</label>
	<div class="form-item">
		<button class="btn submit-btn ajax-post hidden" id="submit"
			type="submit" target-form="form-horizontal">确 定</button>
		<button class="btn btn-return"
			onclick="javascript:history.back(-1);return false;">返 回</button>
	</div>
</form>
</block>

<block name="script"> 
<script type="text/javascript" src="__STATIC__/regionselect.js"></script> 
<script type="text/javascript">
    new PCAS('region_p', 'region_c', 'region_a', '北京', '', '');
</script>
<script type="text/javascript" src="__STATIC__/uploadify/jquery.uploadify.min.js"></script>
<script type="text/javascript">
		//上传图片
	    /* 初始化上传插件 */
		$("#upload_picture_photo").uploadify({
	        "height"          : 30,
	        "swf"             : "__STATIC__/uploadify/uploadify.swf",
	        "fileObjName"     : "download",
	        "buttonText"      : "上传图片",
	        "uploader"        : "{:U('File/uploadPhoto',array('session_id'=>session_id()))}",
	        "width"           : 120,
	        'removeTimeout'	  : 1,
	        'fileTypeExts'	  : '*.jpg; *.png; *.gif;',
	        "onUploadSuccess" : uploadPicturephoto,
	        'onFallback' : function() {
	            alert('未检测到兼容版本的Flash.');
	        }
	    });
		function uploadPicturephoto(file, data){
	    	var data = $.parseJSON(data);
	    	var src = '';
	        if(data.status){
	        	$("#cover_id_photo").val(data.download.path);
	        	src = data.url || '__ROOT__' + data.download.path
	        	$("#cover_id_photo").parent().find('.upload-img-box').html(
	        		'<div class="upload-pre-item"><img src="' + src + '"/></div>'
	        	);
	        } else {
	        	updateAlert(data.info);
	        	setTimeout(function(){
	                $('#top-alert').find('button').click();
	                $(that).removeClass('disabled').prop('disabled',false);
	            },1500);
	        }
	    }
</script>
<script type="text/javascript">
    //导航高亮
    highlight_subnav('{:U('User/expert')}');
    Think.setValue("gender", {$info.gender|default=0});
    Think.setValue("areas", {$info.areas|default=0});
    Think.setValue("status", {$info.status|default=1});
    Think.setValue("education", "{$info.education|default='本科'}");
    Think.setValue("region_p", "{$info.region_p|default='北京市'}");
    Think.setValue("region_c", "{$info.region_c}");
    Think.setValue("region_a", "{$info.region_a}");
    
</script> </block>
